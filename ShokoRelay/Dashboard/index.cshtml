<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Shoko Relay Dashboard</title>
  <link rel="stylesheet" href="css/style.css">
</head>

<body>
  <div id=container>
    <div class="brand-header" role="img" aria-label="Shoko Relay Dashboard"></div>
    <div class="full">
      <section>
        <h3 class="plex">Plex: Authentication</h3>
        <div class="full" id="plex-auth-action">
          <button id="plex-start">Start Plex Auth</button>
        </div>
        <div class="full">
          <div>
            <label>Extra Plex Users (<span id="plex-libraries-count">0</span> Libraries)</label>
            <input id="extra-plex-users" type="text" placeholder="user1;1234, user2;5678 (optional PIN)">
          </div>
        </div>
      </section>
      <section>
        <h3 class="plex">Plex: Automation</h3>
        <div class="full">
          <button id="col-build">Generate Collections</button>
        </div>
        <hr>
        <div class="full">
          <label class="shoko-checkbox">
            <input id="plex-scan-vfs" type="checkbox">
            <span class="shoko-checkbox-icon" aria-hidden="true">
              <svg class="unchecked" viewBox="0 0 24 24">
                <use href="img/icons.svg#checkbox-blank-circle-outline"></use>
              </svg>
              <svg class="checked" viewBox="0 0 24 24">
                <use href="img/icons.svg#checkbox-marked-circle-outline"></use>
              </svg>
            </span>
            <span class="shoko-checkbox-text"><span class="shoko-checkbox-title">Force Partial Scans</span><br>
              <small>Trigger on VFS Change</small>
            </span>
          </label>
          <label class="shoko-checkbox">
            <input id="plex-watched" type="checkbox">
            <span class="shoko-checkbox-icon" aria-hidden="true">
              <svg class="unchecked" viewBox="0 0 24 24">
                <use href="img/icons.svg#checkbox-blank-circle-outline"></use>
              </svg>
              <svg class="checked" viewBox="0 0 24 24">
                <use href="img/icons.svg#checkbox-marked-circle-outline"></use>
              </svg>
            </span>
            <span class="shoko-checkbox-text"><span class="shoko-checkbox-title">Auto Scrobble</span><br>
              <small>Plex Pass Webhook</small>
            </span>
          </label>
        </div>
      </section>
    </div>
    <div class="full">
      <section>
        <h3>
          <svg class="icon-svg" viewBox="0 0 24 24">
            <use href="img/icons.svg#database-refresh-outline"></use>
          </svg>
          Shoko: VFS
        </h3>
        <div class="full">
          <div>
            <label>Filter by ShokoSeriesID</label>
            <input id="vfs-filter" type="text" placeholder="comma separated">
          </div>
        </div>
        <div class="full">
          <button id="vfs-exec">Generate</button>
          <button id="vfs-clean" class="w46-button toggle" title="Clean VFS Toggle" aria-pressed="true" type="button">
            <svg class="icon-svg" viewBox="0 0 24 24">
              <use href="img/icons.svg#broom"></use>
            </svg>
          </button>
        </div>
      </section>
      <section>
        <h3>
          <svg class="icon-svg" viewBox="0 0 24 24">
            <use href="img/icons.svg#auto-fix"></use>
          </svg>
          Shoko: Automation
        </h3>
        <div class="full">
          <div>
            <label>Shoko API Key</label>
            <input id="shoko-api-key" type="password" placeholder="From Shoko's WebUI">
          </div>
          <div class="w100">
            <label title="Automatic Source Import Interval">Import Int.</label>
            <input id="shoko-import-frequency" type="number" min="0" step="1" placeholder="hours">
          </div>
          <div class="w100">
            <label title="Automatic Watched State Sync Interval">Sync Int.</label>
            <input id="shoko-sync-frequency" type="number" min="0" step="1" placeholder="hours">
          </div>
        </div>
        <div class="full">
          <button id="shoko-remove-missing" class="danger" title="Remove Missing Files From Shoko & MyList">
            Remove Missing
          </button>
          <div class="w100"><button id="shoko-import-run" title="Import From Source folders">Import</button>
          </div>
          <div class="w100"><button id="shoko-sync-watched" title="Sync Watched States Menu">Sync</button>
          </div>
        </div>
      </section>
    </div>
    <div class="full">
      <section>
        <h3>
          <svg class="animethemes-svg" viewBox="0 0 160 86.6" width="277" height="150">
            <use href="img/icons.svg#animethemes"></use>
          </svg>
          AnimeThemes: VFS
        </h3>
        <div class="full">
          <div>
            <label>Filter by ShokoSeriesID</label>
            <input id="at-filter-map" type="text" placeholder="comma separated">
          </div>
        </div>
        <div class="full"></div>
        <div class="full">
          <button id="at-apply">Generate</button>
          <button id="at-mapping" class="w100" title="Build Mapping File">Build</button>
          <button id="at-import" class="w100" title="Import Curated Mapping File">Import</button>
        </div>
      </section>
      <section>
        <h3>
          <svg class="animethemes-svg" viewBox="0 0 160 86.6" width="277" height="150">
            <use href="img/icons.svg#animethemes"></use>
          </svg>
          AnimeThemes: Theme.mp3
        </h3>
        <div class="full">
          <div class="at-path-col">
            <label>Path</label><input id="at-path" type="text" placeholder="Shoko or Plex relative anime path">
          </div>
          <div class="w46">
            <label title="Preferred Theme">Slug</label><input id="at-slug" type="text" placeholder="OP2">
          </div>
          <div class="w46">
            <label title="Index Override">Off.</label><input id="at-offset" type="number" value="" placeholder="0">
          </div>
        </div>
        <div class="full">
          <button id="at-single">Generate</button>
          <button id="at-force" class="w46-button toggle" title="Force Overwrite Toggle" aria-pressed="false"
                  type="button" aria-label="Force Overwrite Toggle">
            <svg class="icon-svg" viewBox="0 0 24 24">
              <use href="img/icons.svg#chevron-triple-down"></use>
            </svg>
          </button>
          <button id="at-batch" class="w46-button toggle" title="Recursive Batch Toggle" aria-pressed="false"
                  type="button" aria-label="Recursive Batch Toggle">
            <svg class="icon-svg" viewBox="0 0 24 24">
              <use href="img/icons.svg#file-tree"></use>
            </svg>
          </button>
        </div>
      </section>
    </div>
    <section>
      <h3>
        <svg class="icon-svg" viewBox="0 0 24 24">
          <use href="img/icons.svg#cog-outline"></use>
        </svg>
        Provider Configuration
      </h3>
      <div id="config-form"></div>
      <small>All provider settings are saved automatically.</small>
    </section>
  </div>
  <div id="toast-container" aria-live="polite" aria-atomic="true"></div>

  <!-- Floating Links -->
  <div class="floating-actions" role="navigation" aria-label="Quick links">
    <button id="theme-toggle" class="float-link theme-toggle" aria-label="Toggle theme" aria-pressed="false">
      <svg class="icon-svg" viewBox="0 0 24 24">
        <use href="img/icons.svg#theme-light-dark"></use>
      </svg>
    </button>
    <a class="float-link" href="https://discord.gg/shokoanime" target="_blank" rel="noopener noreferrer"
       aria-label="Shoko Discord">
      <svg class="icon-svg" viewBox="0 0 24 24">
        <use href="img/icons.svg#discord"></use>
      </svg>
    </a>
    <a class="float-link" href="https://docs.shokoanime.com/" target="_blank" rel="noopener noreferrer"
       aria-label="Shoko Docs">
      <svg class="icon-svg" viewBox="0 0 24 24">
        <use href="img/icons.svg#docs"></use>
      </svg>
    </a>
    <a class="float-link github-float" href="https://github.com/natyusha/ShokoRelay" target="_blank"
       rel="noopener noreferrer" aria-label="Shoko Relay on GitHub">
      <svg class="icon-svg" viewBox="0 0 24 24">
        <use href="img/icons.svg#github"></use>
      </svg>
    </a>
  </div>

  <!-- Sync Watched Modal -->
  <div id="sync-modal" class="modal-overlay" aria-hidden="true" role="dialog" aria-modal="true"
       aria-labelledby="sync-modal-title">
    <div class="modal" role="document">
      <header class="modal-header">Sync Watched States</header>
      <div class="modal-body">
        <div style="display:flex;align-items:center;justify-content:space-between;gap:12px;">
          <label style="margin:0">Direction</label>
          <button id="sync-direction-toggle" class="direction-toggle" aria-pressed="false" title="Toggle direction"
                  aria-label="Direction: Plex to Shoko">
            <span class="dir-label">Plex</span>
            <span id="sync-direction-arrow" class="dir-chevron">
              <svg id="dir-icon-right" class="dir-icon dir-icon-right" viewBox="0 0 24 24" aria-hidden="true">
                <use href="img/icons.svg#transfer-right"></use>
              </svg>
              <svg id="dir-icon-left" class="dir-icon dir-icon-left hidden" viewBox="0 0 24 24" aria-hidden="true">
                <use href="img/icons.svg#transfer-left"></use>
              </svg>
            </span>
            <span class="dir-label">Shoko</span>
          </button>
        </div>
        <div style="margin-top:8px;">
          <label class="shoko-checkbox">
            <input id="sync-ratings" type="checkbox">
            <span class="shoko-checkbox-icon" aria-hidden="true">
              <svg class="unchecked" viewBox="0 0 24 24">
                <use href="img/icons.svg#checkbox-blank-circle-outline"></use>
              </svg>
              <svg class="checked" viewBox="0 0 24 24">
                <use href="img/icons.svg#checkbox-marked-circle-outline"></use>
              </svg>
            </span>
            <span class="shoko-checkbox-text"><span class="shoko-checkbox-title">Include Ratings</span><br>
              <small>Sync user vote/rating values</small>
            </span>
          </label>
        </div>
        <div style="margin-top:8px;">
          <label class="shoko-checkbox">
            <input id="sync-exclude-admin" type="checkbox">
            <span class="shoko-checkbox-icon" aria-hidden="true">
              <svg class="unchecked" viewBox="0 0 24 24">
                <use href="img/icons.svg#checkbox-blank-circle-outline"></use>
              </svg>
              <svg class="checked" viewBox="0 0 24 24">
                <use href="img/icons.svg#checkbox-marked-circle-outline"></use>
              </svg>
            </span>
            <span class="shoko-checkbox-text"><span class="shoko-checkbox-title">Exclude Admin</span><br>
              <small>Only sync to extra Plex users</small>
            </span>
          </label>
        </div>
      </div>
      <footer class="modal-actions">
        <button id="sync-cancel-button" class="cancel">Cancel</button>
        <button id="sync-start-button">Start Sync</button>
      </footer>
    </div>
  </div>
  <script src="js/script.js"></script>
</body>

</html>